for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, ind)
}
country.rows
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[3],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
find_doublingcases <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_cases[row.use] / country.table$cum_cases[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
### Calculate number of days it takes for cases to double for
### world.cases
country.codes <- unique(world.cases$countryterritoryCode)
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[3],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
country.rows
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[1],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
country.rows
ind
world.cases <- read.csv('/Users/nancyyu/Documents/R website/First_Website/static/data/WorldCases-10.csv', sep= ',')
find_doublingcases <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_cases[row.use] / country.table$cum_cases[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[1],]
nrow(country.rows)
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
nrow(country.rows)
temp.indices
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
row.currentcase
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
country.rows
country.rows[60:99,]
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[2],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
ind
country.rows[56:98,]
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[3],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
country.rows[62:98,]
country.rows[61:98,]
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[3],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
find_doublingdeaths <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_deaths[row.use] / country.table$cum_deaths[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
countryrows$cum_deaths
country.rows$cum_deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
ind.death
ind
country.rows[36:98,]
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[3],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
# Calculate doubling time for cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
country.rows[36:98,]
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[2],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
# Calculate doubling time for cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
ind
ind.death
country.rows[56:98]
country.rows[56:98,]
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[4],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
# Calculate doubling time for cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
ind
ind.death
country.rows[58:98,]
world.cases[temp.indices,]$cases_doubling
country.rows$cases_doubling
world.cases <- read.csv('/Users/nancyyu/Documents/R website/First_Website/static/data/WorldCases-10.csv', sep= ',')
# iterate over countries from latest day down to Days_10case
find_doublingcases <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_cases[row.use] / country.table$cum_cases[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
find_doublingdeaths <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_deaths[row.use] / country.table$cum_deaths[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
### Calculate number of days it takes for cases to double for
### world.cases
country.codes <- unique(world.cases$countryterritoryCode)
for (i in 1:length(country.codes)) {
# Get the entries for one country
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[i],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
# Calculate doubling time for cumulative cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for cumulative deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
# Copy the numbers to the main table
world.cases[temp.indices,]$cases_doubling <- country.rows$cases_doubling
world.cases[temp.indices,]$deaths_doubling <- country.rows$deaths_doubling
}
ind
country.rows
length(country.codes)
country.codes
length(country.codes)
country.codes[11]
country.codes[10]
unique(world.cases$countryterritoryCode)
length(unique(world.cases$countryterritoryCode))
for (i in 1:10) {
# Get the entries for one country
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[i],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <-temp.indices
# Calculate doubling time for cumulative cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for cumulative deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
# Copy the numbers to the main table
world.cases[temp.indices,]$cases_doubling <- country.rows$cases_doubling
world.cases[temp.indices,]$deaths_doubling <- country.rows$deaths_doubling
}
?write.csv
write.csv(world.cases, file="/Users/nancyyu/Documents/R website/First_Website/static/data/world.cases.test.csv", col.names=TRUE, row.names=FALSE, sep="," )
write.csv(world.cases, file="/Users/nancyyu/Documents/R website/First_Website/static/data/world.cases.test.csv")
world.cases <- read.csv('/Users/nancyyu/Documents/R website/First_Website/static/data/WorldCases-10.csv', sep= ',')
# iterate over countries from latest day down to Days_10case
find_doublingcases <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_cases[row.use] / country.table$cum_cases[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
find_doublingdeaths <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_deaths[row.use] / country.table$cum_deaths[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
### Calculate number of days it takes for cases to double for
### world.cases
country.codes <- unique(world.cases$countryterritoryCode)
for (i in 1:10) {
# Get the entries for one country
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[i],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <- temp.indices
# Calculate doubling time for cumulative cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for cumulative deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
# Copy the numbers to the main table
world.cases[original.indices,]$cases_doubling <- country.rows$cases_doubling
world.cases[original.indices,]$deaths_doubling <- country.rows$deaths_doubling
}
write.csv(world.cases, file="/Users/nancyyu/Documents/R website/First_Website/static/data/world.cases.test.csv")
blogdown:::serve_site()
blogdown:::serve_site()
library('dplyr')
library('ggplot2')
library('RColorBrewer')
library('reshape2')
library('readr')
# To dos:
# - Compare coronavirus death rates with flu virus death rates
# - Plot number of new cases
# - Plot number of deaths
# - Make a Shiny app with adjustable / interactive graphs
# - Kaggle challenge?
setwd('/Users/nancyyu/Documents/CoronaVirusPlots')
options(scipen=100)
#options(stringsAsFactors=FALSE)
`%notin%` <- function(x,y) !(x %in% y)
base_breaks <- function(n = 10){
function(x) {
axisTicks(log10(range(x, na.rm = TRUE)), log = TRUE, n = n)
}
}
world.cases <- read.csv('/Users/nancyyu/Documents/R website/First_Website/static/data/WorldCases-10.csv', sep= ',')
# iterate over countries from latest day down to Days_10case
find_doublingcases <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_cases[row.use] / country.table$cum_cases[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
find_doublingdeaths <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_deaths[row.use] / country.table$cum_deaths[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
### Calculate number of days it takes for cases to double for
### world.cases
country.codes <- unique(world.cases$countryterritoryCode)
for (i in 1:10) {
# Get the entries for one country
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[i],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <- temp.indices
# Calculate doubling time for cumulative cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for cumulative deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
# Copy the numbers to the main table
world.cases[original.indices,]$cases_doubling <- country.rows$cases_doubling
world.cases[original.indices,]$deaths_doubling <- country.rows$deaths_doubling
}
write.csv(world.cases, file="/Users/nancyyu/Documents/R website/First_Website/static/data/world.cases.test.csv")
world.cases <- read.csv('/Users/nancyyu/Documents/R website/First_Website/static/data/WorldCases-10.csv', sep= ',')
# iterate over countries from latest day down to Days_10case
find_doublingcases <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_cases[row.use] / country.table$cum_cases[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
find_doublingdeaths <- function(country.table, row.use) {
count <- 1
row.start <- row.use - 1
numrows_lim <- row.use - 10
for (i in row.start:numrows_lim) {
is.double <- as.numeric(country.table$cum_deaths[row.use] / country.table$cum_deaths[i])
if ( is.double >= 2) {
return(count)
}
else {
count <- count + 1
}
}
return(count)
}
### Calculate number of days it takes for cases to double for
### world.cases
country.codes <- unique(world.cases$countryterritoryCode)
for (i in 1:10) {
# Get the entries for one country
country.rows <- world.cases[world.cases$countryterritoryCode == country.codes[i],]
original.indices <- as.integer(rownames(country.rows))
temp.indices <- 1:nrow(country.rows)
rownames(country.rows) <- temp.indices
# Calculate doubling time for cumulative cases
row.currentcase <- country.rows[country.rows$Days_10cases == 1,]
ind <- as.integer(rownames(row.currentcase))
for (j in ind:nrow(country.rows)) {
country.rows[j,]$cases_doubling <- find_doublingcases(country.rows, j)
}
# Calculate doubling time for cumulative deaths
row.currentdeath <- country.rows[country.rows$Days_5deaths == 1,]
ind.death <- as.integer(rownames(row.currentdeath))
for (k in ind.death:nrow(country.rows)) {
country.rows[k,]$deaths_doubling <- find_doublingdeaths(country.rows, k)
}
# Copy the numbers to the main table
world.cases[original.indices,]$cases_doubling <- country.rows$cases_doubling
world.cases[original.indices,]$deaths_doubling <- country.rows$deaths_doubling
}
write.csv(world.cases, file="/Users/nancyyu/Documents/R website/First_Website/static/data/world.cases.test.csv")
?geom_tile
vignette('ggplot2-specs')
rescale(1:100)
library(scale)
library(scales)
rescale(1:100)
rescale(1)
world.cum.cases <- read_csv(here("static", "data", "WorldCases-10.csv"))
country.codes <- unique(world.cum.cases$countryterritoryCode)
country.n.data <- world.cum.cases[world.cum.cases$countryterritoryCode == 1,]
world.cases <- read.csv('/Users/nancyyu/Documents/R website/First_Website/static/data/WorldCases-10.csv', sep= ',')
world.cum.cases <- world.cases
country.codes <- unique(world.cum.cases$countryterritoryCode)
country.n.data <- world.cum.cases[world.cum.cases$countryterritoryCode == 1,]
rescale(country.n.data$cases_doubling)
country.n.data$cases_doubling
country.n.data$cases_doubling
country.n.data
country.codes <- unique(world.cum.cases$countryterritoryCode)
country.n.data <- world.cum.cases[world.cum.cases$countryterritoryCode == country.codes[1],]
country.n.data
rescale(country.n.data$cases_doubling)
country.n.data$cases_doubling
